Started GET "/" for ::1 at 2024-09-20 15:10:21 +0700
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.5ms | GC: 0.0ms)
Completed 200 OK in 67ms (Views: 18.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 10.0ms)


  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (5.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2024-09-20 08:52:52.757104', '2024-09-20 08:52:52.757110') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateWallets (20240920084836)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_wallets_on_entity_type_and_entity_id" ON "wallets" ("entity_type", "entity_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240920084836') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateTransactions (20240920084838)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "transactions" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "amount" decimal NOT NULL, "source_wallet_id" integer, "target_wallet_id" integer, "transaction_type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TEMPORARY TABLE "atransactions" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "amount" decimal NOT NULL, "source_wallet_id" integer, "target_wallet_id" integer, "transaction_type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "atransactions" ("id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at")
                     SELECT "id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at" FROM "transactions"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE "transactions"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "transactions" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "amount" decimal NOT NULL, "source_wallet_id" integer, "target_wallet_id" integer, "transaction_type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c43e57190f"
FOREIGN KEY ("source_wallet_id")
  REFERENCES "wallets" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "transactions" ("id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at")
                     SELECT "id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at" FROM "atransactions"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "atransactions"[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TEMPORARY TABLE "atransactions" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "amount" decimal NOT NULL, "source_wallet_id" integer, "target_wallet_id" integer, "transaction_type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "atransactions" ("id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at")
                     SELECT "id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at" FROM "transactions"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "transactions"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "transactions" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "amount" decimal NOT NULL, "source_wallet_id" integer, "target_wallet_id" integer, "transaction_type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_c43e57190f"
FOREIGN KEY ("source_wallet_id")
  REFERENCES "wallets" ("id")
, CONSTRAINT "fk_rails_0226e8eeea"
FOREIGN KEY ("target_wallet_id")
  REFERENCES "wallets" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "transactions" ("id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at")
                     SELECT "id","amount","source_wallet_id","target_wallet_id","transaction_type","created_at","updated_at" FROM "atransactions"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "atransactions"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240920084838') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/" for ::1 at 2024-09-20 16:57:03 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate

You have 1 pending migration:

db/migrate/20240920085529_create_entities.rb


):
  
activerecord (7.2.1) lib/active_record/migration.rb:756:in `check_pending_migrations'
activerecord (7.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started GET "/favicon.ico" for ::1 at 2024-09-20 16:57:05 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate

You have 1 pending migration:

db/migrate/20240920085529_create_entities.rb


):
  
activerecord (7.2.1) lib/active_record/migration.rb:756:in `check_pending_migrations'
activerecord (7.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateEntities (20240920085529)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "entities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "type" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240920085529') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/" for ::1 at 2024-09-20 16:59:03 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.9ms | GC: 0.0ms)
Completed 200 OK in 30ms (Views: 9.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.6ms)


Started GET "/" for ::1 at 2024-09-22 05:09:34 +0700
  [1m[36mActiveRecord::SchemaMigration Load (7.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 0.9ms | GC: 0.0ms)
Completed 200 OK in 32ms (Views: 9.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.4ms)


Started GET "/" for 127.0.0.1 at 2024-09-22 05:18:19 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.4ms | GC: 0.0ms)
Completed 200 OK in 43ms (Views: 25.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.2ms)


Started GET "/" for 127.0.0.1 at 2024-09-22 05:24:18 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/apple/.rbenv/versions/3.3.5/lib/ruby/gems/3.3.0/gems/railties-7.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.0ms | GC: 0.0ms)
Completed 200 OK in 28ms (Views: 8.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.0ms)


Started POST "/sign_in" for ::1 at 2024-09-22 05:24:24 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/sign_in" for ::1 at 2024-09-22 05:24:29 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/sign_in" for ::1 at 2024-09-22 05:24:56 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/sign_in" for ::1 at 2024-09-22 05:26:53 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Completed 500 Internal Server Error in 66ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.4ms)


  
NameError (uninitialized constant SessionsController::User):
  
app/controllers/sessions_controller.rb:4:in `create'
Started POST "/sign_in" for ::1 at 2024-09-22 05:30:57 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Completed 500 Internal Server Error in 24ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.4ms)


  
NameError (uninitialized constant SessionsController::User):
  
app/controllers/sessions_controller.rb:4:in `create'
Started POST "/sign_in" for ::1 at 2024-09-22 05:31:02 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
NameError (uninitialized constant SessionsController::User):
  
app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mActiveRecord::InternalMetadata Load (2.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20240921223256)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240921223256') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/sign_in" for ::1 at 2024-09-22 05:33:54 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
Completed 500 Internal Server Error in 86ms (ActiveRecord: 3.2ms (1 query, 0 cached) | GC: 0.7ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: users.name):

Causes:
SQLite3::SQLException (no such column: users.name)
  
Started POST "/sign_in" for ::1 at 2024-09-22 05:35:16 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
Completed 500 Internal Server Error in 67ms (ActiveRecord: 2.6ms (1 query, 0 cached) | GC: 0.9ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: users.email):

Causes:
SQLite3::SQLException (no such column: users.email)
  
Started POST "/sign_in" for ::1 at 2024-09-22 05:45:24 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (2.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
Completed 500 Internal Server Error in 199ms (ActiveRecord: 7.6ms (1 query, 0 cached) | GC: 1.2ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: users.email):

Causes:
SQLite3::SQLException (no such column: users.email)
  
Started POST "/sign_in" for ::1 at 2024-09-22 05:45:28 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
Completed 500 Internal Server Error in 7ms (ActiveRecord: 1.5ms (1 query, 0 cached) | GC: 0.0ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: users.email):

Causes:
SQLite3::SQLException (no such column: users.email)
  
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddEmailAndNameToUsers (20240921230548)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (6.5ms)[0m  [1m[35mALTER TABLE "users" ADD "email" varchar[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "users" ADD "name" varchar[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240921230548') RETURNING "version"[0m
  [1m[36mTRANSACTION (2.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/sign_in" for ::1 at 2024-09-22 06:08:24 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 422 Unprocessable Content in 155ms (Views: 1.5ms | ActiveRecord: 6.7ms (2 queries, 0 cached) | GC: 1.3ms)


Started POST "/sign_in" for ::1 at 2024-09-22 06:10:22 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 422 Unprocessable Content in 317ms (Views: 0.5ms | ActiveRecord: 10.8ms (2 queries, 0 cached) | GC: 1.3ms)


Started POST "/sign_in" for ::1 at 2024-09-22 06:10:26 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 422 Unprocessable Content in 10ms (Views: 0.6ms | ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)


Started POST "/sign_in" for ::1 at 2024-09-22 06:10:28 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 422 Unprocessable Content in 7ms (Views: 0.3ms | ActiveRecord: 0.3ms (2 queries, 0 cached) | GC: 0.0ms)


Started POST "/sign_in" for ::1 at 2024-09-22 06:10:31 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 422 Unprocessable Content in 9ms (Views: 0.3ms | ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)


  [1m[36mUser Load (14.7ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Create (7.5ms)[0m  [1m[32mINSERT INTO "users" ("created_at", "updated_at", "email", "name") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["created_at", "2024-09-21 23:12:52.849083"], ["updated_at", "2024-09-21 23:12:52.849083"], ["email", "[FILTERED]"], ["name", "John Doe"]]
  [1m[36mTRANSACTION (5.1ms)[0m  [1m[36mcommit transaction[0m
Started POST "/sign_in" for ::1 at 2024-09-22 06:13:19 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 500 Internal Server Error in 272ms (ActiveRecord: 10.1ms (2 queries, 0 cached) | GC: 1.2ms)


  
ActionDispatch::Request::Session::DisabledSessionError (Your application has sessions disabled. To write to the session you must first configure a session store):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/sign_in" for ::1 at 2024-09-22 06:20:01 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 500 Internal Server Error in 78ms (ActiveRecord: 3.0ms (2 queries, 0 cached) | GC: 1.0ms)


  
ActionDispatch::Request::Session::DisabledSessionError (Your application has sessions disabled. To write to the session you must first configure a session store):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/sign_in" for ::1 at 2024-09-22 06:22:42 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 500 Internal Server Error in 75ms (ActiveRecord: 4.5ms (2 queries, 0 cached) | GC: 0.8ms)


  
ActionDispatch::Request::Session::DisabledSessionError (Your application has sessions disabled. To write to the session you must first configure a session store):
  
app/controllers/sessions_controller.rb:8:in `create'
Started POST "/sign_in" for ::1 at 2024-09-22 06:25:49 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 200 OK in 71ms (Views: 0.3ms | ActiveRecord: 4.5ms (2 queries, 0 cached) | GC: 0.3ms)


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Create (2.2ms)[0m  [1m[32mINSERT INTO "users" ("created_at", "updated_at", "email", "name") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["created_at", "2024-09-21 23:28:56.871427"], ["updated_at", "2024-09-21 23:28:56.871427"], ["email", "[FILTERED]"], ["name", "Alice"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("created_at", "updated_at", "email", "name") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["created_at", "2024-09-21 23:28:56.880442"], ["updated_at", "2024-09-21 23:28:56.880442"], ["email", "[FILTERED]"], ["name", "Bob"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mcommit transaction[0m
Started POST "/transactions" for ::1 at 2024-09-22 06:31:06 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"amount"=>"100", "target_wallet_id"=>"2", "transaction_type"=>"credit"}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/transactions" for ::1 at 2024-09-22 06:35:17 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"amount"=>"100", "target_wallet_id"=>"2", "transaction_type"=>"credit"}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mWallet Load (0.9ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
Completed 400 Bad Request in 87ms (ActiveRecord: 3.8ms (2 queries, 0 cached) | GC: 0.0ms)


  
ActionController::ParameterMissing (param is missing or the value is empty: transaction):
  
app/controllers/transactions_controller.rb:19:in `transaction_params'
app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mTransaction Create (2.8ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-21 23:36:29.138646"], ["updated_at", "2024-09-21 23:36:29.138646"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mWallet Load (0.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 13:40:40 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"amount"=>"100", "target_wallet_id"=>"2", "transaction_type"=>"credit"}
  [1m[36mWallet Load (0.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mWallet Load (0.7ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
Completed 400 Bad Request in 82ms (ActiveRecord: 4.7ms (2 queries, 0 cached) | GC: 0.1ms)


  
ActionController::ParameterMissing (param is missing or the value is empty: transaction):
  
app/controllers/transactions_controller.rb:19:in `transaction_params'
app/controllers/transactions_controller.rb:7:in `create'
Started POST "/transactions" for ::1 at 2024-09-22 13:43:35 +0700
  
SyntaxError (/Users/apple/Movies/test_rails/app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
  end
  ^~~
):
  
app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
Started POST "/transactions" for ::1 at 2024-09-22 13:44:01 +0700
  
SyntaxError (/Users/apple/Movies/test_rails/app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
  end
  ^~~
):
  
app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
Started POST "/transactions" for ::1 at 2024-09-22 13:44:38 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
SyntaxError (/Users/apple/Movies/test_rails/app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
  end
  ^~~
):
  
app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
Started POST "/transactions" for ::1 at 2024-09-22 13:44:44 +0700
  
SyntaxError (/Users/apple/Movies/test_rails/app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
  end
  ^~~
):
  
app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
Started POST "/transactions" for ::1 at 2024-09-22 13:44:51 +0700
  
SyntaxError (/Users/apple/Movies/test_rails/app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
  end
  ^~~
):
  
app/controllers/transactions_controller.rb:23: syntax error, unexpected `end'
Started POST "/transactions" for ::1 at 2024-09-22 13:46:04 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/transactions" for ::1 at 2024-09-22 13:46:43 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (3.1ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:46:44.336669"], ["updated_at", "2024-09-22 06:46:44.336669"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 87ms (ActiveRecord: 8.9ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddUserIdToWallets (20240922065355)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TEMPORARY TABLE "awallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_awallets_on_entity_type_and_entity_id" ON "awallets" ("entity_type", "entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "awallets" ("id","balance","entity_type","entity_id","created_at","updated_at")
                     SELECT "id","balance","entity_type","entity_id","created_at","updated_at" FROM "wallets"[0m
  [1m[35m (2.5ms)[0m  [1m[35mDROP TABLE "wallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_wallets_on_entity_type_and_entity_id" ON "wallets" ("entity_type", "entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "wallets" ("id","balance","entity_type","entity_id","created_at","updated_at")
                     SELECT "id","balance","entity_type","entity_id","created_at","updated_at" FROM "awallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "awallets"[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_wallets_on_user_id" ON "wallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (1.5ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE TEMPORARY TABLE "awallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "tindex_awallets_on_user_id" ON "awallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_awallets_on_entity_type_and_entity_id" ON "awallets" ("entity_type", "entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "awallets" ("id","balance","entity_type","entity_id","created_at","updated_at","user_id")
                     SELECT "id","balance","entity_type","entity_id","created_at","updated_at","user_id" FROM "wallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "wallets"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL, CONSTRAINT "fk_rails_732f6628c4"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_wallets_on_entity_type_and_entity_id" ON "wallets" ("entity_type", "entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_wallets_on_user_id" ON "wallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "wallets" ("id","balance","entity_type","entity_id","created_at","updated_at","user_id")
                     SELECT "id","balance","entity_type","entity_id","created_at","updated_at","user_id" FROM "awallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "awallets"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240922065355') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/transactions" for ::1 at 2024-09-22 13:55:20 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (1.9ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:55:21.043851"], ["updated_at", "2024-09-22 06:55:21.043851"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 85ms (ActiveRecord: 7.5ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
Started POST "/transactions" for ::1 at 2024-09-22 13:55:27 +0700
Processing by TransactionsController#create as */*
  Parameters: {"amount"=>"100", "target_wallet_id"=>"2", "transaction_type"=>"credit"}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
Completed 400 Bad Request in 6ms (ActiveRecord: 0.4ms (2 queries, 0 cached) | GC: 0.0ms)


  
ActionController::ParameterMissing (param is missing or the value is empty: transaction):
  
app/controllers/transactions_controller.rb:20:in `transaction_params'
app/controllers/transactions_controller.rb:7:in `create'
Started POST "/transactions" for ::1 at 2024-09-22 13:55:33 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTransaction Create (1.6ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:55:33.870506"], ["updated_at", "2024-09-22 06:55:33.870506"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 1.8ms (3 queries, 1 cached) | GC: 1.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
Started POST "/transactions" for ::1 at 2024-09-22 13:56:22 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (1.1ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:56:22.844920"], ["updated_at", "2024-09-22 06:56:22.844920"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 77ms (ActiveRecord: 6.5ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
Started POST "/transactions" for ::1 at 2024-09-22 13:56:51 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.5ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTransaction Create (2.1ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:56:51.608273"], ["updated_at", "2024-09-22 06:56:51.608273"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 17ms (ActiveRecord: 2.7ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mWallet Load (0.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
Started POST "/transactions" for ::1 at 2024-09-22 13:59:03 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (1.7ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 06:59:03.536741"], ["updated_at", "2024-09-22 06:59:03.536741"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 83ms (ActiveRecord: 9.4ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (8.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 14:04:17 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (2.9ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:04:18.168241"], ["updated_at", "2024-09-22 07:04:18.168241"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 89ms (ActiveRecord: 7.3ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
Started POST "/transactions" for ::1 at 2024-09-22 14:04:19 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTransaction Create (1.7ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:04:19.586098"], ["updated_at", "2024-09-22 07:04:19.586098"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 7ms (ActiveRecord: 1.9ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
Started POST "/sign_in" for ::1 at 2024-09-22 14:04:25 +0700
Processing by SessionsController#create as */*
  Parameters: {"name"=>"John Doe"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:4:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."name" = ? LIMIT ?[0m  [["name", "John Doe"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 200 OK in 43ms (Views: 0.2ms | ActiveRecord: 1.3ms (2 queries, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:04:30 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTransaction Create (2.2ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:04:30.363229"], ["updated_at", "2024-09-22 07:04:30.363229"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 9ms (ActiveRecord: 2.5ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT * FROM wallets[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mWallet Load (0.6ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to RemoveEntityFromWallets (20240922071847)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE TEMPORARY TABLE "awallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_type" varchar, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "tindex_awallets_on_user_id" ON "awallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_awallets_on_entity_type_and_entity_id" ON "awallets" ("entity_type", "entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "awallets" ("id","balance","entity_type","entity_id","created_at","updated_at","user_id")
                     SELECT "id","balance","entity_type","entity_id","created_at","updated_at","user_id" FROM "wallets"[0m
  [1m[35m (1.8ms)[0m  [1m[35mDROP TABLE "wallets"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL, CONSTRAINT "fk_rails_732f6628c4"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_wallets_on_entity_type_and_entity_id" ON "wallets" ("entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_wallets_on_user_id" ON "wallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "wallets" ("id","balance","entity_id","created_at","updated_at","user_id")
                     SELECT "id","balance","entity_id","created_at","updated_at","user_id" FROM "awallets"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "awallets"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (1.3ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TEMPORARY TABLE "awallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "entity_id" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "tindex_awallets_on_user_id" ON "awallets" ("user_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "tindex_awallets_on_entity_type_and_entity_id" ON "awallets" ("entity_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "awallets" ("id","balance","entity_id","created_at","updated_at","user_id")
                     SELECT "id","balance","entity_id","created_at","updated_at","user_id" FROM "wallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "wallets"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "wallets" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "balance" decimal DEFAULT 0.0, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, "user_id" integer NOT NULL, CONSTRAINT "fk_rails_732f6628c4"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_wallets_on_user_id" ON "wallets" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "wallets" ("id","balance","created_at","updated_at","user_id")
                     SELECT "id","balance","created_at","updated_at","user_id" FROM "awallets"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "awallets"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240922071847') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/transactions" for ::1 at 2024-09-22 14:19:39 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (1.7ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:19:39.890905"], ["updated_at", "2024-09-22 07:19:39.890905"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 95ms (ActiveRecord: 7.9ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (7.5ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 14:21:17 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:4:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:13:in `validate_wallets'
  [1m[36mTransaction Create (0.9ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:21:17.605515"], ["updated_at", "2024-09-22 07:21:17.605515"]]
  ↳ app/controllers/transactions_controller.rb:9:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:9:in `create'
Completed 500 Internal Server Error in 87ms (ActiveRecord: 7.0ms (3 queries, 1 cached) | GC: 0.0ms)


  
ActiveRecord::InvalidForeignKey (SQLite3::ConstraintException: FOREIGN KEY constraint failed):

Causes:
SQLite3::ConstraintException (FOREIGN KEY constraint failed)
  
  [1m[36mWallet Load (6.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mWallet Create (1.4ms)[0m  [1m[32mINSERT INTO "wallets" ("balance", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["balance", 0.0], ["created_at", "2024-09-22 07:22:13.114798"], ["updated_at", "2024-09-22 07:22:13.114798"], ["user_id", 1]]
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 14:26:48 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (1.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
Completed 422 Unprocessable Content in 87ms (Views: 0.9ms | ActiveRecord: 3.9ms (2 queries, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:30:14 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.7ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 96ms (ActiveRecord: 4.6ms (2 queries, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:32:08 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:5:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
[31mUnpermitted parameter: :source_wallet_id. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x000000011f816738>, params: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}, "controller"=>"transactions", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:12:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:12:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:12:in `create'
Completed 422 Unprocessable Content in 105ms (Views: 0.4ms | ActiveRecord: 6.9ms (3 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:34:17 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 33ms (Views: 0.5ms | ActiveRecord: 4.4ms (2 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:34:42 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 99ms (Views: 0.3ms | ActiveRecord: 5.5ms (2 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:34:44 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 6ms (Views: 0.1ms | ActiveRecord: 0.1ms (2 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:34:57 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 6ms (Views: 0.1ms | ActiveRecord: 0.1ms (2 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:35:08 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTransaction Create (4.2ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:35:08.469499"], ["updated_at", "2024-09-22 07:35:08.469499"]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTransaction Sum (1.0ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."target_wallet_id" = ?[0m  [["target_wallet_id", 1]]
  ↳ app/models/wallet.rb:7:in `balance'
  [1m[36mTransaction Sum (0.1ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."source_wallet_id" = ?[0m  [["source_wallet_id", 1]]
  ↳ app/models/wallet.rb:7:in `balance'
  [1m[36mWallet Update (0.7ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 200.0], ["updated_at", "2024-09-22 07:35:08.515874"], ["id", 1]]
  ↳ app/models/transaction.rb:23:in `process_transaction'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 201 Created in 62ms (Views: 0.3ms | ActiveRecord: 8.2ms (6 queries, 1 cached) | GC: 0.0ms)


  [1m[36mWallet Load (6.9ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 14:38:39 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 90ms (Views: 0.5ms | ActiveRecord: 5.2ms (3 queries, 1 cached) | GC: 0.0ms)


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mWallet Create (0.4ms)[0m  [1m[32mINSERT INTO "wallets" ("balance", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?) RETURNING "id"[0m  [["balance", 0.0], ["created_at", "2024-09-22 07:39:26.417673"], ["updated_at", "2024-09-22 07:39:26.417673"], ["user_id", 2]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mWallet Load (0.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 14:40:23 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mWallet Load (1.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 85ms (Views: 0.4ms | ActiveRecord: 4.2ms (3 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:41:01 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mWallet Load (1.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 422 Unprocessable Content in 10ms (Views: 0.2ms | ActiveRecord: 1.7ms (3 queries, 1 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 14:42:14 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:6:in `create'
  [1m[36mCACHE Wallet Load (0.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTransaction Create (1.5ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:42:14.121168"], ["updated_at", "2024-09-22 07:42:14.121168"]]
  ↳ app/controllers/transactions_controller.rb:17:in `create'
  [1m[36mTransaction Sum (0.2ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."target_wallet_id" = ?[0m  [["target_wallet_id", 2]]
  ↳ app/models/wallet.rb:7:in `balance'
  [1m[36mTransaction Sum (0.1ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."source_wallet_id" = ?[0m  [["source_wallet_id", 2]]
  ↳ app/models/wallet.rb:7:in `balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 200.0], ["updated_at", "2024-09-22 07:42:14.173507"], ["id", 2]]
  ↳ app/models/transaction.rb:23:in `process_transaction'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:17:in `create'
Completed 201 Created in 64ms (Views: 0.7ms | ActiveRecord: 4.2ms (6 queries, 1 cached) | GC: 0.0ms)


  [1m[36mWallet Load (9.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/users" for ::1 at 2024-09-22 14:55:14 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/users"):
  
Started POST "/transactions" for ::1 at 2024-09-22 14:57:19 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/transactions" for ::1 at 2024-09-22 14:58:55 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTransaction Create (0.6ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:58:55.613013"], ["updated_at", "2024-09-22 07:58:55.613013"]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 2]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (1.0ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 2]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 500 Internal Server Error in 142ms (ActiveRecord: 10.1ms (4 queries, 0 cached) | GC: 0.0ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: transactions.wallet_id):

Causes:
SQLite3::SQLException (no such column: transactions.wallet_id)
  
Started POST "/transactions" for ::1 at 2024-09-22 14:59:38 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>2, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (2.1ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 2], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:59:38.913098"], ["updated_at", "2024-09-22 07:59:38.913098"]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 2]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (2.4ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 2]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 500 Internal Server Error in 18ms (ActiveRecord: 5.0ms (4 queries, 0 cached) | GC: 0.0ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: transactions.wallet_id):

Causes:
SQLite3::SQLException (no such column: transactions.wallet_id)
  
Started POST "/transactions" for ::1 at 2024-09-22 14:59:43 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (4.4ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 07:59:43.625939"], ["updated_at", "2024-09-22 07:59:43.625939"]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (1.3ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 500 Internal Server Error in 24ms (ActiveRecord: 6.2ms (4 queries, 0 cached) | GC: 0.0ms)


  
ActiveRecord::StatementInvalid (SQLite3::SQLException: no such column: transactions.wallet_id):

Causes:
SQLite3::SQLException (no such column: transactions.wallet_id)
  
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddWalletIdToTransactions (20240922080351)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.1ms)[0m  [1m[35mALTER TABLE "transactions" ADD "wallet_id" integer[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_wallet_id" ON "transactions" ("wallet_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240922080351') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/transactions" for ::1 at 2024-09-22 15:05:08 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTransaction Create (4.5ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 08:05:09.258915"], ["updated_at", "2024-09-22 08:05:09.258915"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.9ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.2ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 08:05:09.326147"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 158ms (Views: 1.1ms | ActiveRecord: 14.5ms (5 queries, 0 cached) | GC: 0.0ms)


Started POST "/transactions%0A" for ::1 at 2024-09-22 15:07:44 +0700
  
ActionController::RoutingError (No route matches [POST] "/transactions%0A"):
  
Started POST "/transactions%0A" for ::1 at 2024-09-22 15:07:59 +0700
  
ActionController::RoutingError (No route matches [POST] "/transactions%0A"):
  
Started POST "/transactions%0A" for ::1 at 2024-09-22 15:08:26 +0700
  
ActionController::RoutingError (No route matches [POST] "/transactions%0A"):
  
Started POST "/transactions" for ::1 at 2024-09-22 15:11:54 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>50, "source_wallet_id"=>1, "transaction_type"=>"debit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (6.4ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 50.0], ["source_wallet_id", 1], ["target_wallet_id", nil], ["transaction_type", "debit"], ["created_at", "2024-09-22 08:11:54.709687"], ["updated_at", "2024-09-22 08:11:54.709687"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.4ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) - ? WHERE "wallets"."id" = ?[0m  [["balance", 50.0], ["id", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.2ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 08:11:54.739282"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 43ms (Views: 0.7ms | ActiveRecord: 8.6ms (5 queries, 0 cached) | GC: 7.2ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 15:14:20 +0700
  
ActionController::RoutingError (No route matches [GET] "/wallets/1"):
  
Started GET "/wallets/1" for ::1 at 2024-09-22 15:15:32 +0700
  
ActionController::RoutingError (No route matches [GET] "/wallets/1"):
  
  [1m[36mWallet Load (5.3ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started GET "/wallets/1" for ::1 at 2024-09-22 15:19:41 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant WalletsController):

Causes:
ActionDispatch::MissingController (uninitialized constant WalletsController)
NameError (uninitialized constant WalletsController)
  
Started GET "/wallets/1" for ::1 at 2024-09-22 15:21:25 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.6ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 99ms (Views: 3.3ms | ActiveRecord: 3.6ms (1 query, 0 cached) | GC: 0.1ms)


Started GET "/wallets/2" for ::1 at 2024-09-22 15:21:31 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"2"}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/3" for ::1 at 2024-09-22 15:21:35 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"3"}
  [1m[36mWallet Load (0.6ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 404 Not Found in 5ms (ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Wallet with 'id'=3):
  
app/controllers/wallets_controller.rb:8:in `show'
Started POST "/transactions" for ::1 at 2024-09-22 15:22:53 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "source_wallet_id"=>1, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mWallet Load (2.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mrollback transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 422 Unprocessable Content in 55ms (Views: 0.3ms | ActiveRecord: 3.6ms (1 query, 0 cached) | GC: 3.8ms)


Started POST "/transactions" for ::1 at 2024-09-22 15:23:06 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>50, "source_wallet_id"=>1, "transaction_type"=>"debit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (4.7ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 50.0], ["source_wallet_id", 1], ["target_wallet_id", nil], ["transaction_type", "debit"], ["created_at", "2024-09-22 08:23:06.593940"], ["updated_at", "2024-09-22 08:23:06.593940"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.7ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) - ? WHERE "wallets"."id" = ?[0m  [["balance", 50.0], ["id", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.8ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 08:23:06.631125"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 48ms (Views: 0.5ms | ActiveRecord: 8.8ms (5 queries, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 15:23:21 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/users" for ::1 at 2024-09-22 15:24:02 +0700
  
ActionController::RoutingError (No route matches [POST] "/users"):
  
Started GET "/wallets/3" for ::1 at 2024-09-22 15:36:50 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by WalletsController#show as */*
  Parameters: {"id"=>"3"}
Completed 500 Internal Server Error in 52ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.4ms)


  
SyntaxError (/Users/apple/Movies/test_rails/app/models/wallet.rb:17: syntax error, unexpected `end'
  end
  ^~~
):
  
app/models/wallet.rb:17: syntax error, unexpected `end'
app/controllers/wallets_controller.rb:8:in `show'
Started GET "/wallets/3" for ::1 at 2024-09-22 15:37:16 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by WalletsController#show as */*
  Parameters: {"id"=>"3"}
Completed 500 Internal Server Error in 35ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.4ms)


  
SyntaxError (/Users/apple/Movies/test_rails/app/models/wallet.rb:17: syntax error, unexpected `end'
  end
  ^~~
):
  
app/models/wallet.rb:17: syntax error, unexpected `end'
app/controllers/wallets_controller.rb:8:in `show'
Started GET "/wallets/3" for ::1 at 2024-09-22 15:37:39 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by WalletsController#show as */*
  Parameters: {"id"=>"3"}
  [1m[36mWallet Load (0.7ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 404 Not Found in 78ms (ActiveRecord: 3.2ms (1 query, 0 cached) | GC: 1.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Wallet with 'id'=3):
  
app/controllers/wallets_controller.rb:8:in `show'
Started GET "/wallets/3" for ::1 at 2024-09-22 15:37:42 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"3"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 404 Not Found in 6ms (ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Wallet with 'id'=3):
  
app/controllers/wallets_controller.rb:8:in `show'
Started GET "/wallets/2" for ::1 at 2024-09-22 15:37:46 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"2"}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 21ms (Views: 1.4ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 15:37:54 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/users" for ::1 at 2024-09-22 15:38:06 +0700
  
ActionController::RoutingError (No route matches [POST] "/users"):
  
Started POST "/users" for ::1 at 2024-09-22 15:39:46 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant UsersController):

Causes:
ActionDispatch::MissingController (uninitialized constant UsersController)
NameError (uninitialized constant UsersController)
  
Started POST "/users" for ::1 at 2024-09-22 15:42:05 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/users" for ::1 at 2024-09-22 15:42:43 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/users" for ::1 at 2024-09-22 15:44:05 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NoMethodError (undefined method `skip_before_action' for class User):
  
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:2:in `<main>'
Started POST "/users" for ::1 at 2024-09-22 15:45:45 +0700
  [1m[36mActiveRecord::SchemaMigration Load (2.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NoMethodError (undefined method `skip_before_action' for class User):
  
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:2:in `<main>'
Started POST "/users" for ::1 at 2024-09-22 15:45:49 +0700
  
NoMethodError (undefined method `skip_before_action' for class User):
  
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:2:in `<main>'
Started POST "/users" for ::1 at 2024-09-22 15:47:04 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
LoadError (cannot load such file -- bcrypt):
  
app/models/user.rb:3:in `<class:User>'
app/models/user.rb:1:in `<main>'
Started POST "/users" for ::1 at 2024-09-22 15:51:13 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 789ms (ActiveRecord: 4.4ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `password_digest=' for an instance of User):
  
app/controllers/users_controller.rb:5:in `create'
Started POST "/users" for ::1 at 2024-09-22 15:51:20 +0700
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 644ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `password_digest=' for an instance of User):
  
app/controllers/users_controller.rb:5:in `create'
Started POST "/users" for ::1 at 2024-09-22 15:51:35 +0700
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 338ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `password_digest=' for an instance of User):
  
app/controllers/users_controller.rb:5:in `create'
  [1m[36mActiveRecord::InternalMetadata Load (2.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddPasswordDigestToUsers (20240922085229)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (6.7ms)[0m  [1m[35mALTER TABLE "users" ADD "password_digest" varchar[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240922085229') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/users" for ::1 at 2024-09-22 15:53:42 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by UsersController#create as */*
  Parameters: {"user"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mUser Create (11.0ms)[0m  [1m[32mINSERT INTO "users" ("created_at", "updated_at", "email", "name", "password_digest") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["created_at", "2024-09-22 08:53:43.510682"], ["updated_at", "2024-09-22 08:53:43.510682"], ["email", "[FILTERED]"], ["name", nil], ["password_digest", "[FILTERED]"]]
  ↳ app/controllers/users_controller.rb:6:in `create'
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/users_controller.rb:6:in `create'
Completed 201 Created in 642ms (Views: 0.9ms | ActiveRecord: 20.7ms (2 queries, 0 cached) | GC: 24.9ms)


  [1m[36mUser Load (5.3ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/login" for ::1 at 2024-09-22 16:12:27 +0700
  [1m[36mActiveRecord::SchemaMigration Load (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "session"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/login" for ::1 at 2024-09-22 16:14:07 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "session"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/login" for ::1 at 2024-09-22 16:14:22 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "session"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.7) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.7) lib/rack/etag.rb:29:in `call'
rack (3.1.7) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.7) lib/rack/head.rb:15:in `call'
actionpack (7.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.1) lib/action_dispatch/http/content_security_policy.rb:36:in `call'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:272:in `context'
rack-session (2.0.0) lib/rack/session/abstract/id.rb:266:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.7) lib/rack/method_override.rb:28:in `call'
rack (3.1.7) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.7) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.1) lib/rails/engine.rb:535:in `call'
puma (6.4.3) lib/puma/configuration.rb:272:in `call'
puma (6.4.3) lib/puma/request.rb:100:in `block in handle_request'
puma (6.4.3) lib/puma/thread_pool.rb:378:in `with_force_shutdown'
puma (6.4.3) lib/puma/request.rb:99:in `handle_request'
puma (6.4.3) lib/puma/server.rb:464:in `process_client'
puma (6.4.3) lib/puma/server.rb:245:in `block in run'
puma (6.4.3) lib/puma/thread_pool.rb:155:in `block in spawn_thread'
Started POST "/login" for ::1 at 2024-09-22 16:17:53 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by SessionsController#create as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "session"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 401 Unauthorized in 400ms (Views: 0.5ms | ActiveRecord: 7.5ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/login" for ::1 at 2024-09-22 16:19:11 +0700
Processing by SessionsController#create as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "session"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = ? LIMIT ?[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/sessions_controller.rb:5:in `create'
Completed 200 OK in 349ms (Views: 0.3ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 1.8ms)


Started DELETE "/logout" for ::1 at 2024-09-22 16:21:17 +0700
Processing by SessionsController#destroy as */*
Completed 200 OK in 8ms (Views: 0.8ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 16:21:24 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTransaction Create (3.7ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 09:21:24.505475"], ["updated_at", "2024-09-22 09:21:24.505475"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.7ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.7ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (1.1ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 09:21:24.552019"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (3.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 97ms (Views: 0.7ms | ActiveRecord: 14.8ms (5 queries, 0 cached) | GC: 1.6ms)


Started POST "/transactions" for ::1 at 2024-09-22 16:21:29 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>50, "source_wallet_id"=>1, "transaction_type"=>"debit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (3.0ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 50.0], ["source_wallet_id", 1], ["target_wallet_id", nil], ["transaction_type", "debit"], ["created_at", "2024-09-22 09:21:29.052345"], ["updated_at", "2024-09-22 09:21:29.052345"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) - ? WHERE "wallets"."id" = ?[0m  [["balance", 50.0], ["id", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.1ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 09:21:29.064574"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 18ms (Views: 0.3ms | ActiveRecord: 4.0ms (5 queries, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 16:21:33 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/2" for ::1 at 2024-09-22 19:22:12 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"2"}
  [1m[36mWallet Load (7.0ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 33ms (Views: 5.4ms | ActiveRecord: 6.7ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2024-09-22 19:22:26 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>50, "source_wallet_id"=>2, "transaction_type"=>"debit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (5.4ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 50.0], ["source_wallet_id", 2], ["target_wallet_id", nil], ["transaction_type", "debit"], ["created_at", "2024-09-22 12:22:26.948821"], ["updated_at", "2024-09-22 12:22:26.948821"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) - ? WHERE "wallets"."id" = ?[0m  [["balance", 50.0], ["id", 2]]
  ↳ app/models/transaction.rb:26:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.2ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 2]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 12:22:27.080065"], ["id", 2]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 147ms (Views: 0.6ms | ActiveRecord: 7.8ms (5 queries, 0 cached) | GC: 0.0ms)


Started GET "/wallets/2" for ::1 at 2024-09-22 19:22:36 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"2"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


  [1m[36mWallet Load (6.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" /* loading for pp */ LIMIT ?[0m  [["LIMIT", 11]]
Started POST "/transactions" for ::1 at 2024-09-22 19:24:28 +0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/models/transaction.rb:14:in `validate_wallets'
  [1m[36mTransaction Create (0.2ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 12:24:28.572998"], ["updated_at", "2024-09-22 12:24:28.572998"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.2ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.1ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 12:24:28.628495"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 108ms (Views: 0.5ms | ActiveRecord: 5.9ms (5 queries, 0 cached) | GC: 19.4ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 19:24:39 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/9" for ::1 at 2024-09-22 19:25:00 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"9"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 404 Not Found in 3ms (ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Wallet with 'id'=9):
  
app/controllers/wallets_controller.rb:8:in `show'
Started POST "/transactions" for ::1 at 2024-09-22 19:25:35 +0700
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"amount"=>100, "target_wallet_id"=>1, "transaction_type"=>"credit"}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mTransaction Create (1.0ms)[0m  [1m[32mINSERT INTO "transactions" ("amount", "source_wallet_id", "target_wallet_id", "transaction_type", "created_at", "updated_at", "wallet_id") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["amount", 100.0], ["source_wallet_id", nil], ["target_wallet_id", 1], ["transaction_type", "credit"], ["created_at", "2024-09-22 12:25:35.286709"], ["updated_at", "2024-09-22 12:25:35.286709"], ["wallet_id", nil]]
  ↳ app/controllers/transactions_controller.rb:7:in `create'
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mWallet Update All (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = COALESCE("balance", 0) + ? WHERE "wallets"."id" = ?[0m  [["balance", 100.0], ["id", 1]]
  ↳ app/models/transaction.rb:24:in `block in update_wallet_balances'
  [1m[36mTransaction Sum (0.1ms)[0m  [1m[34mSELECT SUM("transactions"."amount") FROM "transactions" WHERE "transactions"."wallet_id" = ?[0m  [["wallet_id", 1]]
  ↳ app/models/wallet.rb:11:in `calculate_balance'
  [1m[36mWallet Update (0.2ms)[0m  [1m[33mUPDATE "wallets" SET "balance" = ?, "updated_at" = ? WHERE "wallets"."id" = ?[0m  [["balance", 0.0], ["updated_at", "2024-09-22 12:25:35.315173"], ["id", 1]]
  ↳ app/models/wallet.rb:12:in `calculate_balance'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[36mcommit transaction[0m
  ↳ app/controllers/transactions_controller.rb:7:in `create'
Completed 201 Created in 34ms (Views: 0.3ms | ActiveRecord: 2.5ms (5 queries, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 19:25:44 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 19:25:47 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.2ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/1" for ::1 at 2024-09-22 19:25:48 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/wallets/9" for ::1 at 2024-09-22 19:25:52 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"9"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 404 Not Found in 14ms (ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 11.4ms)


  
ActiveRecord::RecordNotFound (Couldn't find Wallet with 'id'=9):
  
app/controllers/wallets_controller.rb:8:in `show'
Started GET "/wallets/1" for ::1 at 2024-09-22 19:25:59 +0700
Processing by WalletsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mWallet Load (0.1ms)[0m  [1m[34mSELECT "wallets".* FROM "wallets" WHERE "wallets"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/wallets_controller.rb:8:in `show'
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)


